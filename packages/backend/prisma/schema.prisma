// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

model Persoon {
  id                  Int            @id @default(autoincrement())
  voornaam            String?        @db.VarChar(128)
  achternaam          String         @db.VarChar(128)
  volledigeNaam       String         @db.VarChar(256)
  emailadres          String?        @db.VarChar(256)
  verblijfadresId     Int
  verblijfadres       Adres          @relation(name: "verblijfadres", fields: [verblijfadresId], references: [id])
  domicilieadresId    Int? // indien anders dan verblijfadres is deze gevuld
  domicilieadres      Adres?         @relation(name: "domicilieadres", fields: [domicilieadresId], references: [id])
  geboortedatum       DateTime?      @db.Date
  geboorteplaats      String?        @db.VarChar(256)
  geslacht            Geslacht       @default(onbekend)
  rekeningnummer      String?        @db.VarChar(256)
  rijksregisternummer String?        @db.VarChar(256)
  telefoonnummer      String?        @db.VarChar(256)
  gsmNummer           String?        @db.VarChar(256)
  // communicatievoorkeur Communicatievoorkeur @default(post)
  type                PersoonType    @default(deelnemer)
  inschrijving        Inschrijving[]


  // Deelnemer
  woonsituatie          Woonsituatie    @default(onbekend)
  woonsituatieOpmerking String?
  werksituatie          Werksituatie    @default(onbekend)
  opleidingsvorm        Opleidingsvorm?
  werksituatieOpmerking String?
  voedingswens          Voedingswens    @default(geen)
  voedingswensOpmerking String?
  Deelnames             Deelname[]

  // OverigePersonen
  vrijwilligerOpmerking String?
  selectie              OverigPersoonSelectie[]

  @@map("persoon")
}

model Adres {
  id         Int     @id @default(autoincrement())
  plaats     Plaats  @relation(fields: [plaatsId], references: [id])
  straatnaam String  @db.VarChar(64)
  huisnummer String  @db.VarChar(10)
  busnummer  String? @db.VarChar(10)
  plaatsId   Int

  verblijfpersoon   Persoon[]     @relation("verblijfadres")
  domiciliepersonen Persoon[]     @relation("domicilieadres")
  Organisatie       Organisatie[]
  @@map("adres")
}

model Plaats {
  id            Int    @id @default(autoincrement())
  deelgemeente  String @db.VarChar(256)
  gemeente      String @db.VarChar(256)
  postcode      String @unique @db.VarChar(10)
  volledigeNaam String @db.VarChar(256)
  provincieId   Int

  Adres        Adres[]
  Inschrijving Inschrijving[]
  @@index(deelgemeente)
  @@index(gemeente)
  @@index(provincieId)
  @@map("plaats")
}

model Project {
  id             Int            @id @default(autoincrement())
  projectnummer  String         @unique @db.VarChar(256)
  type           ProjectType
  naam           String         @db.VarChar(256)
  activiteiten   Activiteit[]
  inschrijvingen Inschrijving[]

  // Cursus
  organisatieonderdeel Organisatieonderdeel?
  overnachting         Boolean?

  @@map("project")
}

model Inschrijving {
  id                             Int       @id @default(autoincrement())
  projectId                      Int
  project                        Project   @relation(fields: [projectId], references: [id])
  deelnemerId                    Int
  deelnemer                      Persoon   @relation(fields: [deelnemerId], references: [id])
  woonplaatsDeelnemerId          Int
  woonplaatsDeelnemer            Plaats    @relation(fields: [woonplaatsDeelnemerId], references: [id])
  opmerking                      String?   @db.VarChar(256)
  tijdstipVanInschrijving        DateTime  @default(now())
  tijdstipVanAnnuleren           DateTime?
  tijdstipVanBevestiging         DateTime?
  tijdstipVerzendenVervoersbrief DateTime?
  toestemmingFotos               Boolean   @default(false)
  wachtlijst                     Boolean   @default(false)

  @@map("inschrijving")
}

model Activiteit {
  id           Int      @id @default(autoincrement())
  project      Project  @relation(fields: [projectId], references: [id])
  projectId    Int
  van          DateTime @db.Date
  totEnMet     DateTime @db.Date
  vormingsuren Float?

  deelnames Deelname[]
  @@map("activiteit")
}

model Deelname {
  id                         Int        @id @default(autoincrement())
  deelnemer                  Persoon    @relation(fields: [deelnemerId], references: [id])
  deelnemerId                Int
  activiteit                 Activiteit @relation(fields: [activiteitId], references: [id])
  activiteitId               Int
  effectieveDeelnamePerunage Float

  @@map("deelname")
}

model Organisatie {
  id                   Int                   @id @default(autoincrement())
  naam                 String                @unique @db.VarChar(256)
  terAttentieVan       String?               @db.VarChar(256)
  emailadres           String?               @db.VarChar(256)
  adres                Adres?                @relation(fields: [adresId], references: [id])
  adresId              Int?
  opmerking            String?               @db.VarChar(1024)
  doelgroep            Doelgroep
  telefoonnummer       String?
  website              String?               @db.VarChar(256)
  folderVoorkeur       FolderSelectie[]
  communicatieVoorkeur CommunicatieVoorkeur?

  @@map("organisatie")
}

enum CommunicatieVoorkeur {
  post
  email

  @@map("communicatie_voorkeur")
}

enum FolderSelectie {
  deKeiCursussen
  deKeiZomervakanties
  deKeiWintervakanties
  KeiJongNietBuso
  KeiJongBuso
}

enum ProjectType {
  cursus
  vakantie

  @@map("project_type")
}

enum OverigPersoonSelectie {
  algemeneVergaderingKeiJong
  algemeneVergaderingDeKei
  overheid
  personeel
  vakantieVrijwilliger

  @@map("overig_persoon_selectie")
}

enum Organisatieonderdeel {
  keiJongBuSO
  keiJongNietBuSO
  deKei

  @@map("organisatieonderdeel")
}

enum PersoonType {
  deelnemer
  overigPersoon

  @@map("persoon_type")
}

enum Geslacht {
  onbekend
  man
  vrouw

  @@map("geslacht")
}

enum Woonsituatie {
  onbekend
  thuisZonderProfessioneleBegeleiding
  thuisMetProfessioneleBegeleiding
  residentieleWoonondersteuning
  zelfstandigZonderProfessioneleBegeleiding
  zelfstandigMetProfessioneleBegeleiding

  @@map("woonsituatie")
}

enum Opleidingsvorm {
  onbekend
  opleidingsvorm1
  opleidingsvorm2
  opleidingsvorm3
  alternerendeBeroepsopleiding
  regulierOnderwijsMetExtraOndersteuning

  @@map("opleidingsvorm")
}

enum Werksituatie {
  onbekend
  school
  dagbesteding
  vrijwilligerswerk
  maatwerkbedrijf
  arbeidszorg
  arbeidstrajectbegeleiding
  reguliereArbeidscircuit
  pensioen
  werkzoekend

  @@map("werksituatie")
}

enum Voedingswens {
  geen
  vegetarisch
  halal
  andere

  @@map("voedingswens")
}

enum Doelgroep {
  deKei
  keiJong

  @@map("doelgroep")
}

enum VakantieVerblijf {
  geen
  hotelOfPension
  vakantiehuis
  boot
}

enum VakantieVervoer {
  geen
  minibus
  autocarOverdag
  autocarNacht
}
